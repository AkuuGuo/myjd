"use strict";$(function(){function c(){$(".checkedAll").prop("checked",!0),$(".checkedAll2").prop("checked",!0),$(".checked1").each(function(c,e){e.checked||($(".checkedAll").prop("checked",!1),$(".checkedAll2").prop("checked",!1))})}function s(c){for(var e=JSON.parse(localStorage.getItem("cart")),t=$(this).parents(".msg").siblings(".shop").children("p").html(),s=$(this).parents(".msg").find(".item-type").html(),i=0;i<e.length;i++)if(e[i].id==t)for(var n=0;n<e[i].data.length;n++)if(e[i].data[n].type==s){e[i].data[n].num=c;var a=JSON.stringify(e);localStorage.setItem("cart",a)}}function a(){var c=JSON.parse(localStorage.getItem("cart")),t=0;$.each(c,function(c,e){t+=e.data.length}),$(".cart i").html(t)}function i(){var s=0,i=0;$(".checked2").each(function(c,e){var t=1*$(".checked2").eq(c).parents(".msg").find(".money").html().substring(1);e.checked&&(s+=t,i++)}),$(".sum-count").html("￥"+s.toFixed(2)),$(".choose i").html(i)}!function(){$(".list").remove();var i=JSON.parse(localStorage.getItem("cart")),n="";$.each(i,function(s,c){n+='\n                <div class="list lis">\n                    <div class="shop">\n                        <input type="checkbox" class="items checked1"><p>'.concat(i[s].id,"</p>\n                    </div>"),$(i[s].data).each(function(c,e){var t=(1*i[s].data[c].price.substring(1)*i[s].data[c].num).toFixed(2);n+='<div class="msg"> \n                <span class="check"><input type="checkbox" class="items checked2"></span>\n                <div class="fr">\n                    <h2>购满1件，即可享受换购优惠</h2>\n                    <div class="cart-banner"><img src="'.concat(i[s].data[c].img,'" alt=""></div>\n                    <h6 class="cart-h">').concat(i[s].data[c].msg,'</h6>\n                    <div class="item-type">').concat(i[s].data[c].type,'</div>\n                    <div class="price">\n                        <p class="cart-price">').concat(i[s].data[c].price,'</p>\n                    </div>\n                    <div class="msg-count">\n                        <button class="subtracts">-</button>\n                        <input type="text" value="').concat(i[s].data[c].num,'" class="txt num">\n                        <button class="adds">+</button>\n                    </div>\n                    <div class="money">￥').concat(t,'</div>\n                    <a href="#" class="del">删除</a>\n                </div>                   \n            </div> ')}),n+="</div>"}),a(),""==n&&$(".goShop").css("display","block").siblings().css("display","none");$(".cart-form").append($(n))}(),$(".txt").change(function(){var c=$(this).parent().siblings(".price").children(".cart-price").html().substring(1);0==$(this).val()&&$(this).val(1);var e=($(this).val()*c).toFixed(2);$(this).parent().siblings(".money").html("￥"+e),s.call($(this),+$(this).val()),i()}),$(".subtracts").click(function(){var c=$(this).parent().siblings(".price").children(".cart-price").html().substring(1),e=+$(this).next().val();--e<1&&(e=1),$(this).next().val(e);var t=(c*e).toFixed(2);return $(this).parent().siblings(".money").html("￥"+t),s.call($(this),e),i(),!1}),$(".adds").click(function(){var c=$(this).parent().siblings(".price").children(".cart-price").html().substring(1),e=+$(this).prev().val();e++,$(this).prev().val(e);var t=(c*e).toFixed(2);return $(this).parent().siblings(".money").html("￥"+t),s.call($(this),e),i(),!1}),$(".del").click(function(){return function(c,e){for(var t=JSON.parse(localStorage.getItem("cart")),s=0;s<t.length;s++)if(t[s].id==c){for(var i=0;i<t[s].data.length;i++)if(t[s].data[i].type==e){t[s].data.splice(i,1);var n=JSON.stringify(t);localStorage.setItem("cart",n)}if(0==t[s].data.length){t.splice(s,1);var n=JSON.stringify(t);localStorage.setItem("cart",n)}}0==t.length&&(localStorage.removeItem("cart"),$(".goShop").css("display","block").siblings().css("display","none"));a()}($(this).parents(".msg").siblings(".shop").children("p").html(),$(this).parents(".msg").find(".item-type").html()),$(this).parents(".list").children(".msg").length-1==0&&$(this).parents(".list").remove(),$(this).parents(".msg").remove(),i(),!1}),$(".checkedAll").click(function(){$(".list").find("input").prop("checked",!0),$(".checkedAll2").prop("checked",!0),$(".checkedAll").prop("checked")||($(".list").find("input").prop("checked",!1),$(".checkedAll2").prop("checked",!1))}),$(".checkedAll2").click(function(){$(".list").find("input").prop("checked",!0),$(".checkedAll").prop("checked",!0),$(".checkedAll2").prop("checked")||($(".list").find("input").prop("checked",!1),$(".checkedAll").prop("checked",!1))}),$(".checked1").click(function(){$(this).parents(".shop").siblings(".msg").find(".checked2").prop("checked",!0),$(this).prop("checked")||$(this).parents(".shop").siblings(".msg").find(".checked2").prop("checked",!1),c()}),$(".checked2").click(function(){$(this).parents(".msg").siblings(".shop").children(".checked1").prop("checked",!0),$(this).parents(".list").find(".checked2").each(function(c,e){e.checked||$(this).parents(".msg").siblings(".shop").children(".checked1").prop("checked",!1)}),c()}),$("#cart input").click(i),$(".goShop").find(".go").hover(function(){$(this).css("color","red")},function(){$(this).css("color","rgb(0,94,167)")}),$(".clearCart").click(function(){return localStorage.removeItem("cart"),a(),$(".goShop").css("display","block").siblings().css("display","none"),!1}),$(".remove").click(function(c){c.preventDefault();var t=[],e=["a","b","c","d","e","f"];console.log(e),$(".checked2").each(function(c,e){e.checked&&t.push($(e).parents(".msg").index())}),$(".checked1").each(function(c,e){e.checked&&$(e).parents(".list").remove()}),t.reverse(),console.log(t);for(var s=0;s<t.length;s++)e.splice(t[s],1);console.log(e)})});